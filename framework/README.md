# ğŸ® Discord Activities Game Framework

> Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ¸Ğ³Ñ€Ñ‹ Ğ´Ğ»Ñ Discord Activities Ğ·Ğ° Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹, Ğ° Ğ½Ğµ Ğ¼ĞµÑÑÑ†Ñ‹.

ĞœĞ¾Ğ´ÑƒĞ»ÑŒĞ½Ñ‹Ğ¹ Ñ„Ñ€ĞµĞ¹Ğ¼Ğ²Ğ¾Ñ€Ğº Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ²ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ñ… Ğ¸Ğ³Ñ€, Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‰Ğ¸Ñ… ĞºĞ°Ğº Discord Activities. Ğ’ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ **4 ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ° Ğ¶Ğ°Ğ½Ñ€Ğ¾Ğ²**, **CLI-Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€**, **13 Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹ ÑĞ´Ñ€Ğ°** Ğ¸ Ğ¿Ğ¾Ğ»Ğ½ÑƒÑ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ.

---

## ğŸ“‹ ĞĞ³Ğ»Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

- [Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚](#-Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹-ÑÑ‚Ğ°Ñ€Ñ‚)
- [ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°](#-Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°)
- [Ğ¯Ğ´Ñ€Ğ¾ (Core Library)](#-ÑĞ´Ñ€Ğ¾-core-library)
- [CLI-Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€](#-cli-Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€)
- [Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹ Ğ¶Ğ°Ğ½Ñ€Ğ¾Ğ²](#-ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ñ‹-Ğ¶Ğ°Ğ½Ñ€Ğ¾Ğ²)
- [ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ](#-ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ)
- [Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ²](#-ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°-Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ²)
- [Ğ˜Ğ½Ñ‚ĞµÑ€Ğ½Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (i18n)](#-Ğ¸Ğ½Ñ‚ĞµÑ€Ğ½Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ-i18n)
- [ĞŸĞµÑ€ÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ (Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)](#-Ğ¿ĞµÑ€ÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ)
- [Discord Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ](#-discord-Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ)
- [Ğ¢ĞµÑÑ‚Ñ‹](#-Ñ‚ĞµÑÑ‚Ñ‹)
- [Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹](#-Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹)
- [ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞ³Ğ¾ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°](#-Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ)
- [API Reference](#-api-reference)

---

## ğŸš€ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

- Node.js 20+
- Discord-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ñ Ğ²ĞºĞ»ÑÑ‡Ñ‘Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Activities
- `DISCORD_CLIENT_ID` Ğ¸ `DISCORD_CLIENT_SECRET`

### 1. Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ñ„Ñ€ĞµĞ¹Ğ¼Ğ²Ğ¾Ñ€ĞºĞ°

```bash
cd framework/core
npm install
npm run build
```

### 2. Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° CLI

```bash
cd framework/cli
npx tsc
```

### 3. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```bash
# Ğ˜Ğ· ĞºĞ¾Ñ€Ğ½Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°:
node framework/cli/dist/index.js my-farm --genre farm

# Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· npm-ÑĞºÑ€Ğ¸Ğ¿Ñ‚ (Ğ¸Ğ· framework/):
cd framework
npm run create-game -- my-farm --genre farm
```

### 4. Ğ—Ğ°Ğ¿ÑƒÑĞº

```bash
cd my-farm
npm install
npm run dev
# ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ http://localhost:8080
```

---

## ğŸ— ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
framework/
â”œâ”€â”€ core/           # Ğ¯Ğ´Ñ€Ğ¾ Ñ„Ñ€ĞµĞ¹Ğ¼Ğ²Ğ¾Ñ€ĞºĞ° (13 Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹)
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ types.ts          # Ğ“ĞµĞ½ĞµÑ€Ğ¸Ğº-Ñ‚Ğ¸Ğ¿Ñ‹ (GameConfig, BasePlayerState, ...)
â”‚       â”œâ”€â”€ eventBus.ts       # Pub/Sub Ğ´Ğ»Ñ React â†” Phaser
â”‚       â”œâ”€â”€ stateManager.ts   # Ğ–Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ» ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ°
â”‚       â”œâ”€â”€ persistence.ts    # ĞĞ´Ğ°Ğ¿Ñ‚ĞµÑ€Ñ‹: Memory, LocalFile
â”‚       â”œâ”€â”€ discordBridge.ts  # ĞĞ±Ñ‘Ñ€Ñ‚ĞºĞ° Discord SDK + OAuth
â”‚       â”œâ”€â”€ contentManager.ts # Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° JSON-ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ° + ĞºĞµÑˆ
â”‚       â”œâ”€â”€ assetManager.ts   # Ğ¡Ğ¿Ñ€Ğ°Ğ¹Ñ‚Ñ‹ / Ğ°ÑƒĞ´Ğ¸Ğ¾ + Phaser-Ñ‚ĞµĞºÑÑ‚ÑƒÑ€Ñ‹
â”‚       â”œâ”€â”€ baseServer.ts     # Express-Ñ„Ğ°Ğ±Ñ€Ğ¸ĞºĞ° (auth, CRUD, content, admin)
â”‚       â”œâ”€â”€ baseScene.ts      # Phaser-ÑÑ†ĞµĞ½Ğ° (ÑĞµÑ‚ĞºĞ°, Ğ¿ÑƒĞ»Ñ‹, ÑÑ„Ñ„ĞµĞºÑ‚Ñ‹)
â”‚       â”œâ”€â”€ i18n.ts           # Ğ˜Ğ½Ñ‚ĞµÑ€Ğ½Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
â”‚       â”œâ”€â”€ config.ts         # Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ° + env-Ğ¿ĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ
â”‚       â”œâ”€â”€ plugin.ts         # Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ²
â”‚       â””â”€â”€ index.ts          # Barrel-ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚
â”œâ”€â”€ cli/            # CLI-Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ index.ts          # ĞŸĞ°Ñ€ÑĞµÑ€ Ğ°Ñ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
â”‚       â””â”€â”€ generator.ts      # Ğ”Ğ²Ğ¸Ğ¶Ğ¾Ğº ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ¾Ğ²
â”œâ”€â”€ templates/      # 4 Ğ¶Ğ°Ğ½Ñ€Ğ¾Ğ²Ñ‹Ñ… ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ°
â”‚   â”œâ”€â”€ farm/         # ğŸŒ¾ Ğ¤ĞµÑ€Ğ¼Ğ°
â”‚   â”œâ”€â”€ card-battle/  # ğŸƒ ĞšĞ°Ñ€Ñ‚Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ±Ğ¸Ñ‚Ğ²Ğ°
â”‚   â”œâ”€â”€ trivia/       # â“ Ğ’Ğ¸ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ°
â”‚   â””â”€â”€ match-3/      # ğŸ’ ĞŸĞ°Ğ·Ğ»
â”œâ”€â”€ docs/           # Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
â”œâ”€â”€ tests/          # Unit-Ñ‚ĞµÑÑ‚Ñ‹
â””â”€â”€ vitest.config.ts
```

### Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ĞšĞ»Ğ¸ĞµĞ½Ñ‚ (Ğ‘Ñ€Ğ°ÑƒĞ·ĞµÑ€) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   EventBus    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ React UI â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Phaser Scene â”‚    â”‚  DiscordBridge   â”‚   â”‚
â”‚  â”‚ (Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸) â”‚               â”‚ (Ğ¾Ñ‚Ñ€Ğ¸ÑĞ¾Ğ²ĞºĞ°)  â”‚    â”‚  (SDK + auth)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚                            â”‚                     â”‚              â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€ HTTP/fetch â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                    â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Express Ğ¡ĞµÑ€Ğ²ĞµÑ€                                  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  BaseServer   â”‚  â”‚ StateManager â”‚  â”‚ContentManagerâ”‚  â”‚PluginMgr   â”‚  â”‚
â”‚  â”‚ (Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹)    â”‚  â”‚ (CRUD+save)  â”‚  â”‚ (CMS-Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ) â”‚  â”‚(Ñ…ÑƒĞºĞ¸)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                             â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚                  â”‚PersistenceAdapterâ”‚                                    â”‚
â”‚                  â”‚ Memory â”‚ File    â”‚                                    â”‚
â”‚                  â”‚ GCS    â”‚ Redis   â”‚                                    â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Ğ¯Ğ´Ñ€Ğ¾ (Core Library)

### Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° (Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ¾Ğ²)

```bash
cd framework/core
npm install
npm run build
```

ĞŸĞ¾ÑĞ»Ğµ ÑĞ±Ğ¾Ñ€ĞºĞ¸ Ğ²ÑĞµ Ğ¼Ğ¾Ğ´ÑƒĞ»Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ñ‡ĞµÑ€ĞµĞ· ĞµĞ´Ğ¸Ğ½Ñ‹Ğ¹ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚:

```typescript
import {
  EventBus,
  StateManager,
  MemoryAdapter,
  LocalFileAdapter,
  DiscordBridge,
  ContentManager,
  AssetManager,
  BaseServer,
  BaseScene,
  I18n,
  PluginManager,
  definePlugin,
  loadGameConfig,
  loadGameConfigWithEnv,
} from "@discord-activities/core";
```

### ĞœĞ¾Ğ´ÑƒĞ»Ğ¸ ÑĞ´Ñ€Ğ° â€” Ğ¿Ğ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾

#### 1. `types.ts` â€” Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ‚Ğ¸Ğ¿Ğ¾Ğ²

Ğ’ÑĞµ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ğº-Ğ¾Ğ²Ñ‹Ğµ. ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ğ¸Ğ³Ñ€Ğ° Ñ€Ğ°ÑÑˆĞ¸Ñ€ÑĞµÑ‚ `BasePlayerState`:

```typescript
// Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ÑÑ‚ĞµĞ¹Ñ‚ (Ğ² ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ğ¸Ğ³Ñ€Ğµ)
interface BasePlayerState {
  id: string; // Discord user ID
  username: string; // Ğ˜Ğ¼Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
  discordId?: string;
  lastSaved?: number; // Ğ¢Ğ°Ğ¹Ğ¼ÑÑ‚Ğ°Ğ¼Ğ¿ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ³Ğ¾ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ
}

// Ğ’Ğ°Ñˆ ÑÑ‚ĞµĞ¹Ñ‚ Ñ€Ğ°ÑÑˆĞ¸Ñ€ÑĞµÑ‚ Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹:
interface MyFarmState extends BasePlayerState {
  coins: number;
  level: number;
  inventory: Record<string, number>;
  placedItems: PlacedItem[];
}
```

Ğ”Ñ€ÑƒĞ³Ğ¸Ğµ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹:

- `GameConfig` â€” ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ³Ñ€Ñ‹ (Ğ¶Ğ°Ğ½Ñ€, ÑĞµÑ€Ğ²ĞµÑ€, Ñ€ĞµĞ½Ğ´ĞµÑ€, Discord)
- `GameAction<TPayload>` â€” Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ° (type + payload)
- `ActionResult<TState>` â€” Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ
- `GameEvent<TData>` â€” ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ğ´Ğ»Ñ EventBus
- `ContentItem` â€” Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚-ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚ (id, name, sprite, localized\*)
- `GamePlugin<TState>` â€” Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ° Ñ Ñ…ÑƒĞºĞ°Ğ¼Ğ¸
- `IPersistenceAdapter<TState>` â€” Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğ°

#### 2. `eventBus.ts` â€” Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹

```typescript
const bus = new EventBus();

// ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°
bus.on("player:levelup", (data) => console.log(`Level up! ${data.level}`));

// ĞĞ´Ğ½Ğ¾ĞºÑ€Ğ°Ñ‚Ğ½Ğ°Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°
bus.once("game:start", () => console.log("Ğ˜Ğ³Ñ€Ğ° Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ°ÑÑŒ"));

// ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ°
bus.emit("player:levelup", { level: 5 });

// ĞÑ‚Ğ¿Ğ¸ÑĞºĞ°
const handler = () => {};
bus.on("test", handler);
bus.off("test", handler);

// ĞÑ‡Ğ¸ÑÑ‚ĞºĞ°
bus.clear("player:levelup"); // Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑĞ»ÑƒÑˆĞ°Ñ‚ĞµĞ»ĞµĞ¹ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ
bus.clear(); // Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ’Ğ¡Ğ• ÑĞ»ÑƒÑˆĞ°Ñ‚ĞµĞ»Ğ¸

// ĞšĞ¾Ğ»-Ğ²Ğ¾ ÑĞ»ÑƒÑˆĞ°Ñ‚ĞµĞ»ĞµĞ¹
bus.listenerCount("player:levelup"); // â†’ 0
```

#### 3. `stateManager.ts` â€” Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸ĞµĞ¼

```typescript
const stateManager = new StateManager<MyFarmState>(
  new MemoryAdapter<MyFarmState>(), // Ğ˜Ğ»Ğ¸ LocalFileAdapter("data/db.json")
  { coins: 500, level: 1, inventory: {} }, // Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ
  eventBus,
  { saveDebounceMs: 3000 }, // Ğ—Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ¿ĞµÑ€ĞµĞ´ Ğ°Ğ²Ñ‚Ğ¾ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸ĞµĞ¼
);

await stateManager.init();

// ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ/ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ÑÑ‚ĞµĞ¹Ñ‚
const player = stateManager.get("user123", "Alice");
// â†’ { id: "user123", username: "Alice", coins: 500, level: 1, ... }

// ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚ĞµĞ¹Ñ‚ (Ğ¸Ğ¼Ğ¼ÑƒÑ‚Ğ°Ğ±ĞµĞ»ÑŒĞ½Ğ¾)
const updated = stateManager.update("user123", (state) => ({
  ...state,
  coins: state.coins + 100,
}));

// ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ½Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ
const unsubscribe = stateManager.subscribe((state, action) => {
  console.log(`Ğ˜Ğ³Ñ€Ğ¾Ğº ${state.id} Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»Ñ‘Ğ½`);
});
unsubscribe(); // ĞÑ‚Ğ¿Ğ¸ÑĞºĞ°

// ĞŸÑ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ
await stateManager.saveNow();

// Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°
stateManager.playerCount; // 1
stateManager.getPlayerIds(); // ["user123"]
stateManager.has("user123"); // true
```

#### 3.1. ĞŸÑ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ñ‹Ğ¹ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½: GameStore (Slices)

Ğ”Ğ»Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹ (ĞºĞ°Ğº **Game Hub**) Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½ **Slice**, Ğ²Ğ´Ğ¾Ñ…Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ Redux/Zustand. Ğ­Ñ‚Ğ¾ Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµÑ‚ Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒ Ğ¼Ğ¾Ğ½Ğ¾Ğ»Ğ¸Ñ‚Ğ½Ñ‹Ğ¹ ÑÑ‚ĞµĞ¹Ñ‚ Ğ½Ğ° Ğ½ĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ñ‹Ğµ Ğ¼Ğ¾Ğ´ÑƒĞ»Ğ¸.

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹ (ÑĞ¼. `examples/game-hub/public/js/store.js`):

```javascript
// store.js
const createStore = (set, get) => ({
  resources: createResourcesSlice(set, get), // âš¡ Ğ­Ğ½ĞµÑ€Ğ³Ğ¸Ñ, Ğ·Ğ¾Ğ»Ğ¾Ñ‚Ğ¾
  farm: createFarmSlice(set, get), // ğŸŒ± Ğ“Ñ€ÑĞ´ĞºĞ¸, Ğ¸Ğ½Ğ²ĞµĞ½Ñ‚Ğ°Ñ€ÑŒ
  pet: createPetSlice(set, get), // ğŸ¾ ĞŸĞ¸Ñ‚Ğ¾Ğ¼ĞµÑ†
});

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğµ
const { energy } = useStore((state) => state.resources);
```

#### 4. `persistence.ts` â€” ĞĞ´Ğ°Ğ¿Ñ‚ĞµÑ€Ñ‹ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğ°

| ĞĞ´Ğ°Ğ¿Ñ‚ĞµÑ€            | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ             | ĞšĞ¾Ğ³Ğ´Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ       |
| ------------------ | -------------------- | ------------------------ |
| `MemoryAdapter`    | Ğ’ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğ¹ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ | Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°, Ñ‚ĞµÑÑ‚Ñ‹        |
| `LocalFileAdapter` | JSON-Ñ„Ğ°Ğ¹Ğ» Ğ½Ğ° Ğ´Ğ¸ÑĞºĞµ   | ĞĞ´Ğ¸Ğ½Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ÑĞµÑ€Ğ²ĞµÑ€         |
| GCS / Redis        | ĞĞ±Ğ»Ğ°Ñ‡Ğ½Ğ¾Ğµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ   | ĞŸÑ€Ğ¾Ğ´Ğ°ĞºÑˆĞ½, Ğ¼ÑƒĞ»ÑŒÑ‚Ğ¸-Ğ¸Ğ½ÑÑ‚Ğ°Ğ½Ñ |

```typescript
// ĞŸĞ°Ğ¼ÑÑ‚ÑŒ (Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ‚ĞµÑ€ÑÑÑ‚ÑÑ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞµ)
const memory = new MemoryAdapter<MyState>();

// Ğ¤Ğ°Ğ¹Ğ» (Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑÑ‚ÑÑ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°Ğ¼Ğ¸)
const file = new LocalFileAdapter<MyState>("data/players.json");

// ĞĞ±Ğ° Ñ€ĞµĞ°Ğ»Ğ¸Ğ·ÑƒÑÑ‚ IPersistenceAdapter:
await adapter.init();
await adapter.save("id", state);
const loaded = await adapter.load("id");
await adapter.saveAll(statesMap);
const all = await adapter.loadAll();
await adapter.delete("id");
await adapter.close();
```

#### 5. `baseServer.ts` â€” Express-ÑĞµÑ€Ğ²ĞµÑ€

Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ ÑĞµÑ€Ğ²ĞµÑ€ Ñ Ñ‚Ğ¸Ğ¿Ğ¾Ğ²Ñ‹Ğ¼Ğ¸ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ°Ğ¼Ğ¸:

| ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚                    | ĞœĞµÑ‚Ğ¾Ğ´ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ                           |
| -------------------------- | ----- | ---------------------------------- |
| `/api/health`              | GET   | ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒÑ + ĞºĞ¾Ğ»-Ğ²Ğ¾ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ¾Ğ² |
| `/api/token`               | POST  | Discord OAuth2 Ğ¾Ğ±Ğ¼ĞµĞ½ codeâ†’token    |
| `/api/content`             | GET   | Ğ’ĞµÑÑŒ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ Ğ¸Ğ³Ñ€Ñ‹ (Ñ ETag-ĞºĞµÑˆĞµĞ¼)   |
| `/api/content/version`     | GET   | Ğ’ĞµÑ€ÑĞ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ° (Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»Ğ»Ğ¸Ğ½Ğ³Ğ°)     |
| `/api/content/:type`       | GET   | ĞšĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¹ Ñ‚Ğ¸Ğ¿ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°            |
| `/api/state`               | GET   | Ğ¡Ñ‚ĞµĞ¹Ñ‚ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ° (auth)       |
| `/api/state/:userId`       | GET   | Ğ¡Ñ‚ĞµĞ¹Ñ‚ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ³Ğ¾ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ° (Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹)   |
| `/api/state`               | POST  | Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ ÑÑ‚ĞµĞ¹Ñ‚ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ° (auth)      |
| `/api/players`             | GET   | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¸Ğ³Ñ€Ğ¾ĞºĞ¾Ğ² Ğ´Ğ»Ñ ÑĞ¾Ñ†. Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹    |
| `/admin/api/content`       | GET   | Ğ’ĞµÑÑŒ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ (admin auth)          |
| `/admin/api/content/:type` | PUT   | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ (admin auth)      |

```typescript
const server = new BaseServer({
  config: { port: 8080, adminPanel: true, adminPasswordEnv: "ADMIN_PASSWORD" },
  stateManager,
  contentManager,
  discordClientId: process.env.DISCORD_CLIENT_ID,
  discordClientSecret: process.env.DISCORD_CLIENT_SECRET,
  validateState: (data) => MyStateSchema.safeParse(data), // Zod-Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
});

// Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ²Ğ¾Ğ¸ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹
const auth = server.getAuthMiddleware();
server.app.post("/api/farm/plant", auth, (req, res) => {
  // Ğ’Ğ°ÑˆĞ° Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¿Ğ¾ÑĞ°Ğ´ĞºĞ¸
  res.json({ success: true });
});

// Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ĞºĞ° + SPA
server.serveStatic("dist");
server.addSPACatchAll("dist/index.html"); // Ğ’Ñ‹Ğ·Ğ²Ğ°Ñ‚ÑŒ ĞŸĞĞ¡Ğ›Ğ•Ğ”ĞĞ˜Ğœ

await server.start();

// Graceful shutdown
process.on("SIGTERM", () => server.shutdown());
```

#### 6. `baseScene.ts` â€” Phaser-ÑÑ†ĞµĞ½Ğ°

ĞĞ±ÑÑ‚Ñ€Ğ°ĞºÑ‚Ğ½Ñ‹Ğ¹ Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ»Ğ°ÑÑ Ğ´Ğ»Ñ 2D-Ğ¸Ğ³Ñ€:

```typescript
class MyFarmScene extends BaseScene {
  constructor() {
    super({
      key: "FarmScene",
      grid: {
        width: 16,
        height: 16,
        tileWidth: 64,
        tileHeight: 32,
        isometric: true,
      },
      backgroundColor: 0x2f3136,
      eventBus: gameBus,
      assetManager: assets,
    });
  }

  create() {
    // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚ Ğ·ÑƒĞ¼Ğ°
    this.cameras.main.setZoom(this.calculateZoom());

    // ĞšĞ»Ğ¸Ğº Ğ¿Ğ¾ ÑĞµÑ‚ĞºĞµ
    this.input.on("pointerdown", (ptr) => {
      const world = this.cameras.main.getWorldPoint(ptr.x, ptr.y);
      const { gridX, gridY } = this.getGridFromScreen(world.x, world.y);
      if (this.isValidGrid(gridX, gridY)) {
        this.gameBus.emit("grid:click", { gridX, gridY });
      }
    });
  }

  drawScene() {
    this.resetPools(); // Ğ¡Ğ±Ñ€Ğ¾Ñ Ğ¿ÑƒĞ»Ğ¾Ğ² Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ²
    this.drawGrid(); // Ğ¡ĞµÑ‚ĞºĞ°
    this.drawHighlight(5, 5); // ĞŸĞ¾Ğ´ÑĞ²ĞµÑ‚ĞºĞ° Ñ‚Ğ°Ğ¹Ğ»Ğ°
    this.showFloatingText(5, 5, "+10 ğŸª™", "#ffcc00"); // ĞĞ½Ğ¸Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ‚ĞµĞºÑÑ‚
  }
}
```

ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹:

- `getScreenFromGrid(x, y)` / `getGridFromScreen(x, y)` â€” ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚
- `isValidGrid(x, y)` â€” Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†
- `drawGrid()` / `drawHighlight()` â€” Ğ¾Ñ‚Ñ€Ğ¸ÑĞ¾Ğ²ĞºĞ° ÑĞµÑ‚ĞºĞ¸
- `showFloatingText()` â€” Ğ²ÑĞ¿Ğ»Ñ‹Ğ²Ğ°ÑÑ‰Ğ¸Ğ¹ Ñ‚ĞµĞºÑÑ‚ Ñ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸ĞµĞ¹
- `getGraphics()` / `getText()` â€” Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ· Ğ¿ÑƒĞ»Ğ° (0 Ğ°Ğ»Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸Ğ¹)
- `resetPools()` â€” ÑĞ±Ñ€Ğ¾Ñ Ğ¿ÑƒĞ»Ğ¾Ğ² (Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ² Ğ½Ğ°Ñ‡Ğ°Ğ»Ğµ `drawScene`)

---

## ğŸ”§ CLI-Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€

### ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°

```bash
node framework/cli/dist/index.js <Ğ¸Ğ¼Ñ-Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°> [Ğ¾Ğ¿Ñ†Ğ¸Ğ¸]
```

### ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€        | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ               | Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ                                   | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ |
| --------------- | ---------------------- | ------------------------------------------ | ------------ |
| `--genre`       | Ğ–Ğ°Ğ½Ñ€ Ğ¸Ğ³Ñ€Ñ‹              | `farm`, `card-battle`, `trivia`, `match-3` | `farm`       |
| `--persistence` | Ğ¥Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ              | `memory`, `local-file`, `gcs`              | `memory`     |
| `--locale`      | Ğ›Ğ¾ĞºĞ°Ğ»Ğ¸ (Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ°Ğ¿ÑÑ‚ÑƒÑ) | `en`, `ru`, `de`, ...                      | `en`         |
| `--theme`       | Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²Ğ°Ñ Ñ‚ĞµĞ¼Ğ°          | `discord`, `dark`, `light`                 | `discord`    |

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹

```bash
# Ğ¤ĞµÑ€Ğ¼Ğ° Ñ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸ĞµĞ¼ Ğ² Ñ„Ğ°Ğ¹Ğ»
node framework/cli/dist/index.js my-farm --genre farm --persistence local-file

# Ğ’Ğ¸ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ° Ğ½Ğ° Ğ´Ğ²ÑƒÑ… ÑĞ·Ñ‹ĞºĞ°Ñ…
node framework/cli/dist/index.js quiz-night --genre trivia --locale en,ru

# ĞšĞ°Ñ€Ñ‚Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ¸Ğ³Ñ€Ğ°
node framework/cli/dist/index.js card-arena --genre card-battle

# ĞŸĞ°Ğ·Ğ» match-3
node framework/cli/dist/index.js gem-blast --genre match-3
```

### Ğ§Ñ‚Ğ¾ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ

```
my-farm/
â”œâ”€â”€ game.config.json       # ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ñ Ğ¿Ğ¾Ğ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸
â”œâ”€â”€ server.js              # Ğ¡ĞµÑ€Ğ²ĞµÑ€ (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ Ğ² ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğµ)
â”œâ”€â”€ .env                   # Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½ ÑĞµĞºÑ€ĞµÑ‚Ğ¾Ğ²
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ types.ts           # Ğ¢Ğ¸Ğ¿Ñ‹ Ğ´Ğ»Ñ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ¶Ğ°Ğ½Ñ€Ğ°
â”‚   â”œâ”€â”€ engine/            # Ğ”Ğ²Ğ¸Ğ¶Ğ¾Ğº Ğ¸Ğ³Ñ€Ñ‹ (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)
â”‚   â””â”€â”€ scenes/            # Phaser-ÑÑ†ĞµĞ½Ñ‹ (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)
â””â”€â”€ data/content/          # JSON ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚
```

### ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ¾Ğ²

CLI Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ğ¾Ğ´ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ ÑÑ‚Ğ¸ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ² Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…:

| ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ        | ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ |
| ----------------- | --------------- |
| `{{GAME_ID}}`     | `my-farm`       |
| `{{GAME_TITLE}}`  | `My Farm`       |
| `{{GAME_GENRE}}`  | `farm`          |
| `{{PERSISTENCE}}` | `memory`        |
| `{{LOCALES}}`     | `["en","ru"]`   |
| `{{VERSION}}`     | `0.1.0`         |

---

## ğŸ¯ Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹ Ğ¶Ğ°Ğ½Ñ€Ğ¾Ğ²

### Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ

| Ğ–Ğ°Ğ½Ñ€           | Ğ ĞµĞ½Ğ´ĞµÑ€ĞµÑ€       | ĞœÑƒĞ»ÑŒÑ‚Ğ¸Ğ¿Ğ»ĞµĞµÑ€ | Ğ˜Ğ³Ñ€Ğ¾Ğ²Ğ¾Ğ¹ Ğ´Ğ²Ğ¸Ğ¶Ğ¾Ğº   | ĞšĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚           |
| -------------- | -------------- | ----------- | ---------------- | ----------------- |
| ğŸŒ¾ Farm        | Phaser 3 (ISO) | Ğ”Ğ° (Ğ²Ğ¸Ğ·Ğ¸Ñ‚Ñ‹) | FarmScene        | items, crops      |
| ğŸƒ Card Battle | DOM/React      | PvAI        | CardBattleEngine | cards (7 ÑˆÑ‚.)     |
| â“ Trivia      | DOM/React      | Ğ”Ğ°          | TriviaEngine     | questions (8 ÑˆÑ‚.) |
| ğŸ’ Match-3     | Canvas         | Ğ¡Ğ¾Ğ»Ğ¾        | Match3Engine     | â€” (Ğ¿Ñ€Ğ¾Ñ†ĞµĞ´ÑƒÑ€Ğ½Ğ°Ñ)   |

### ğŸŒ¾ Farm â€” Ğ¤ĞµÑ€Ğ¼ĞµÑ€ÑĞºĞ¸Ğ¹ ÑĞ¸Ğ¼ÑƒĞ»ÑÑ‚Ğ¾Ñ€

**Ğ¤Ğ°Ğ¹Ğ»Ñ‹:** `game.config.json`, `types.ts`, `FarmScene.ts`, `server.js`, `items.json`, `crops.json`

Ğ˜Ğ·Ğ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ„ĞµÑ€Ğ¼Ğ°:

- ĞŸĞ¾ÑĞ°Ğ´ĞºĞ° Ğ¸ ÑĞ±Ğ¾Ñ€ ÑƒÑ€Ğ¾Ğ¶Ğ°Ñ
- Ğ”ĞµĞºĞ¾Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚
- Ğ’Ğ¸Ğ·Ğ¸Ñ‚Ñ‹ Ğº Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼
- ĞŸĞ¸Ñ‚Ğ¾Ğ¼Ñ†Ñ‹

```typescript
// types.ts â€” Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ BasePlayerState
interface FarmPlayerState extends BasePlayerState {
  coins: number;
  gems: number;
  inventory: Record<string, number>;
  rooms: Record<string, FarmRoom>;
  pets: PetInstance[];
}
```

### ğŸƒ Card Battle â€” ĞšĞ°Ñ€Ñ‚Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ±Ğ¸Ñ‚Ğ²Ğ°

**Ğ¤Ğ°Ğ¹Ğ»Ñ‹:** `game.config.json`, `types.ts`, `CardBattleEngine.ts`, `cards.json`

ĞŸĞ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ¾Ğ¹ Ñ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸:

- Ğ¡Ğ±Ğ¾Ñ€ Ğ¸ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ»Ğ¾Ğ´Ñ‹
- 6 ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²: ĞĞ³Ğ¾Ğ½ÑŒ, Ğ’Ğ¾Ğ´Ğ°, Ğ—ĞµĞ¼Ğ»Ñ, Ğ’Ğ¾Ğ·Ğ´ÑƒÑ…, Ğ¢ÑŒĞ¼Ğ°, Ğ¡Ğ²ĞµÑ‚
- AI-Ğ¿Ñ€Ğ¾Ñ‚Ğ¸Ğ²Ğ½Ğ¸Ğº
- Ğ Ğ°Ñ€Ğ¸Ñ‚ĞµÑ‚Ñ‹: Common, Rare, Epic, Legendary

```typescript
// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ĞºĞ°Ñ€Ñ‚Ñ‹ Ğ¸Ğ· cards.json
{
  "id": "earth_golem",
  "name": "Earth Golem",
  "rarity": "rare",
  "type": "creature",
  "attack": 5,
  "health": 8,
  "element": "earth"
}
```

### â“ Trivia â€” Ğ’Ğ¸ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ°

**Ğ¤Ğ°Ğ¹Ğ»Ñ‹:** `game.config.json`, `types.ts`, `TriviaEngine.ts`, `questions.json`

ĞšĞ²Ğ¸Ğ· Ñ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€Ğ¾Ğ¼ Ğ¸ Ğ¾Ñ‡ĞºĞ°Ğ¼Ğ¸:

- ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ + ÑƒÑ€Ğ¾Ğ²Ğ½Ğ¸ ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸ (easy / medium / hard)
- ĞÑ‡ĞºĞ¸ Ğ·Ğ° Ğ²Ñ€ĞµĞ¼Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° (Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ = Ğ±Ğ¾Ğ»ÑŒÑˆĞµ)
- Ğ¡ĞµÑ€Ğ¸Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² (ÑÑ‚Ñ€Ğ¸ĞºĞ¸)
- Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ñ‹Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ (Technology, Science)

```typescript
// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑĞ° Ğ¸Ğ· questions.json
{
  "id": "q1",
  "question": "In which city is Discord's headquarters?",
  "correctAnswer": "San Francisco",
  "wrongAnswers": ["New York", "Seattle", "Los Angeles"],
  "difficulty": "easy",
  "points": 100
}
```

### ğŸ’ Match-3 â€” ĞŸĞ°Ğ·Ğ»

**Ğ¤Ğ°Ğ¹Ğ»Ñ‹:** `game.config.json`, `types.ts`, `Match3Engine.ts`

ĞšĞ»Ğ°ÑÑĞ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ match-3:

- Ğ¡ĞµÑ‚ĞºĞ° 8Ã—8 Ñ 6 Ñ‚Ğ¸Ğ¿Ğ°Ğ¼Ğ¸ ĞºĞ°Ğ¼Ğ½ĞµĞ¹
- ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğ¹ (Ğ³Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚ + Ğ²ĞµÑ€Ñ‚Ğ¸Ğº)
- Ğ“Ñ€Ğ°Ğ²Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ñ + ĞºĞ°ÑĞºĞ°Ğ´Ñ‹
- Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° ĞºĞ¾Ğ¼Ğ±Ğ¾ (Ğ´Ğ¾ 5Ã— Ğ¼Ğ½Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒ)
- Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ´Ğ¾ÑĞºĞ¸ Ğ±ĞµĞ· Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğ¹

---

## âš™ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ğ¸Ğ³Ñ€Ğ° Ğ¸Ğ¼ĞµĞµÑ‚ `game.config.json`:

```json
{
  "id": "my-game",
  "title": "My Awesome Game",
  "description": "...",
  "genre": "farm",
  "version": "0.1.0",
  "locales": ["en", "ru"],
  "persistence": "local-file",
  "discord": {
    "clientId": "YOUR_CLIENT_ID",
    "scopes": ["identify", "rpc.activities.write"]
  },
  "rendering": {
    "type": "phaser",
    "grid": {
      "width": 16,
      "height": 16,
      "tileWidth": 64,
      "tileHeight": 32,
      "isometric": true
    },
    "backgroundColor": 3092790
  },
  "server": {
    "port": 8080,
    "adminPanel": true,
    "adminPasswordEnv": "ADMIN_PASSWORD"
  },
  "features": {
    "multiplayer": true,
    "leaderboard": true
  }
}
```

Env-Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ **Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿ĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑÑÑ‚** ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³:

| Env                 | ĞŸĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚     |
| ------------------- | ------------------ |
| `DISCORD_CLIENT_ID` | `discord.clientId` |
| `PORT`              | `server.port`      |
| `GAME_PERSISTENCE`  | `persistence`      |

---

## ğŸ”Œ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ²

Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ğ±ĞµĞ· Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ´Ğ° ÑĞ´Ñ€Ğ°:

```typescript
import { definePlugin, PluginManager } from "@discord-activities/core";

// ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°
const xpDoubler = definePlugin({
  id: "weekend-xp",
  name: "Weekend XP Doubler",
  version: "1.0.0",
  hooks: {
    onInit: (config) => {
      console.log(`Plugin initialized for: ${config.title}`);
    },

    // ĞŸĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚ ĞŸĞ•Ğ Ğ•Ğ” Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¾Ğ¹ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¼Ğ¾Ğ´Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ Ğ¾Ñ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ)
    beforeAction: (action, state) => {
      if (action.type === "cheat") return null; // ĞÑ‚Ğ¼ĞµĞ½Ğ°
      return action; // ĞŸÑ€Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ
    },

    // ĞŸĞ¾ÑĞ»Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ
    afterAction: (action, result) => {
      if (result.success) {
        console.log(`Action ${action.type} succeeded`);
      }
    },

    // Ğ˜Ğ³Ñ€Ğ¾Ğ²Ğ¾Ğ¹ Ñ‚Ğ¸Ğº (Ğ´Ğ»Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸)
    onTick: (delta, state) => {
      /* ... */
    },

    // ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ/Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ°
    onPlayerJoin: (playerId) => {
      /* ... */
    },
    onPlayerLeave: (playerId) => {
      /* ... */
    },

    // ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸
    onDestroy: async () => {
      /* ... */
    },
  },
});

// Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ
const plugins = new PluginManager();
plugins.register(xpDoubler);
await plugins.initAll(gameConfig);

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² Ğ¸Ğ³Ñ€Ğ¾Ğ²Ğ¾Ğ¼ Ñ†Ğ¸ĞºĞ»Ğµ
const action = plugins.runBeforeAction(rawAction, state);
if (action) {
  const result = processAction(action, state);
  plugins.runAfterAction(action, result);
}
```

### Ğ–Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ» Ñ…ÑƒĞºĞ¾Ğ²

```
onInit â”€â”€â–º onPlayerJoin â”€â”€â–º beforeAction â”€â”€â–º afterAction â”€â”€â–º onTick
                                  â”‚
                                  â””â”€â”€â–º return null (Ğ¾Ñ‚Ğ¼ĞµĞ½Ğ° Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ)

onPlayerLeave â”€â”€â–º onDestroy
```

---

## ğŸŒ Ğ˜Ğ½Ñ‚ĞµÑ€Ğ½Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (i18n)

```typescript
import { I18n } from "@discord-activities/core";

const i18n = new I18n("en");

// Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ¾Ğ²
i18n.load("en", {
  ui: {
    shop: { title: "Shop", buy: "Buy for {{price}} coins" },
  },
  items: { tomato: "Tomato" },
});

i18n.load("ru", {
  ui: {
    shop: { title: "ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½", buy: "ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ Ğ·Ğ° {{price}} Ğ¼Ğ¾Ğ½ĞµÑ‚" },
  },
  items: { tomato: "ĞŸĞ¾Ğ¼Ğ¸Ğ´Ğ¾Ñ€" },
});

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
i18n.t("ui.shop.title"); // â†’ "Shop"
i18n.t("ui.shop.buy", { price: 100 }); // â†’ "Buy for 100 coins"

// ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ·Ñ‹ĞºĞ°
i18n.setLocale("ru");
i18n.t("ui.shop.title"); // â†’ "ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½"
i18n.t("ui.shop.buy", { price: 100 }); // â†’ "ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ Ğ·Ğ° 100 Ğ¼Ğ¾Ğ½ĞµÑ‚"

// Ğ¤Ğ¾Ğ»Ğ±ÑĞº Ğ½Ğ° ÑĞ·Ñ‹Ğº Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ
i18n.t("unknown.key"); // â†’ "unknown.key" (ĞºĞ»ÑÑ‡ ĞºĞ°Ğº ĞµÑÑ‚ÑŒ)

// Ğ”Ğ»Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚-ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² Ñ Ğ¿Ğ¾Ğ»ÑĞ¼Ğ¸ localizedNames
const item = { name: "Tomato", localizedNames: { ru: "ĞŸĞ¾Ğ¼Ğ¸Ğ´Ğ¾Ñ€" } };
i18n.tField(item, "name"); // â†’ "ĞŸĞ¾Ğ¼Ğ¸Ğ´Ğ¾Ñ€" (ĞµÑĞ»Ğ¸ locale = "ru")
```

---

## ğŸ’¾ ĞŸĞµÑ€ÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ

### Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ°Ğ´Ğ°Ğ¿Ñ‚ĞµÑ€Ğ°

| ĞĞ´Ğ°Ğ¿Ñ‚ĞµÑ€            | Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ‚ĞµÑ€ÑÑÑ‚ÑÑ? | ĞœÑƒĞ»ÑŒÑ‚Ğ¸-Ğ¸Ğ½ÑÑ‚Ğ°Ğ½Ñ? | ĞšĞ¾Ğ³Ğ´Ğ°           |
| ------------------ | :--------------: | :-------------: | --------------- |
| `MemoryAdapter`    |      âœ… Ğ”Ğ°       |     âŒ ĞĞµÑ‚      | Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°      |
| `LocalFileAdapter` |      âŒ ĞĞµÑ‚      |     âŒ ĞĞµÑ‚      | ĞŸÑ€Ğ¾Ğ´ (1 ÑĞµÑ€Ğ²ĞµÑ€) |
| GCS / Redis        |      âŒ ĞĞµÑ‚      |      âœ… Ğ”Ğ°      | ĞŸÑ€Ğ¾Ğ´ (scale)    |

### Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞ²Ğ¾ĞµĞ³Ğ¾ Ğ°Ğ´Ğ°Ğ¿Ñ‚ĞµÑ€Ğ°

Ğ ĞµĞ°Ğ»Ğ¸Ğ·ÑƒĞ¹Ñ‚Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ `IPersistenceAdapter<TState>`:

```typescript
class RedisAdapter<
  TState extends BasePlayerState,
> implements IPersistenceAdapter<TState> {
  async init() {
    /* Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Redis */
  }
  async load(id: string) {
    /* redis.get */
  }
  async save(id: string, state: TState) {
    /* redis.set */
  }
  async loadAll() {
    /* redis.keys + mget */
  }
  async saveAll(states: Map<string, TState>) {
    /* pipeline set */
  }
  async listPlayers() {
    /* redis.keys */
  }
  async delete(id: string) {
    /* redis.del */
  }
  async close() {
    /* redis.quit */
  }
}
```

---

## ğŸ® Discord Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ

### DiscordBridge (ĞºĞ»Ğ¸ĞµĞ½Ñ‚)

```typescript
const bridge = new DiscordBridge({
  clientId: "YOUR_CLIENT_ID",
  scopes: ["identify", "rpc.activities.write"],
  tokenEndpoint: "/api/token",
  eventBus: gameBus,
});

await bridge.init();
console.log(bridge.user); // { id, username, avatar, ... }
console.log(bridge.accessToken); // OAuth access token

// Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
await bridge.setActivity("Playing Farm", "Level 5", {
  largeImage: "farm_logo",
  largeText: "My Farm Game",
});

// Ğ–Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ»
gameBus.on("discord:lifecycle", ({ state }) => {
  // "initializing" â†’ "authenticating" â†’ "ready" | "error"
});
```

### ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€Ğµ

`BaseServer` Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ñ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚:

- `POST /api/token` â€” Ğ¾Ğ±Ğ¼ĞµĞ½ OAuth-ĞºĞ¾Ğ´Ğ° Ğ½Ğ° access_token
- `requireAuth` middleware â€” Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Bearer-Ñ‚Ğ¾ĞºĞµĞ½Ğ° Ñ‡ĞµÑ€ĞµĞ· Discord API

---

## ğŸ§ª Ğ¢ĞµÑÑ‚Ñ‹

### Ğ—Ğ°Ğ¿ÑƒÑĞº

```bash
cd framework
npm install
npm test
```

### ĞŸĞ¾ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ

| ĞœĞ¾Ğ´ÑƒĞ»ÑŒ       | Ğ¢ĞµÑÑ‚Ğ¾Ğ² | Ğ§Ñ‚Ğ¾ Ñ‚ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ                            |
| ------------ | ------ | ------------------------------------------ |
| EventBus     | 8      | emit, off, once, clear, edge cases         |
| StateManager | 9      | CRUD, Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸, event bus, Ğ¸Ğ¼Ğ¼ÑƒÑ‚Ğ°Ğ±ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ |
| i18n         | 8      | ĞºĞ»ÑÑ‡Ğ¸, Ğ¸Ğ½Ñ‚ĞµÑ€Ğ¿Ğ¾Ğ»ÑÑ†Ğ¸Ñ, Ñ„Ğ¾Ğ»Ğ±ÑĞº, tField        |
| Plugin       | 7      | Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ, Ñ…ÑƒĞºĞ¸, Ğ¼Ğ¾Ğ´Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ, Ğ¾Ñ‚Ğ¼ĞµĞ½Ğ°     |
| Config       | 4      | Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ñ‹, merge, deep merge, env            |
| Persistence  | 7      | CRUD, deep clone, batch, cleanup           |

#### Game Hub (`examples/game-hub`)

Game Hub Ğ¸Ğ¼ĞµĞµÑ‚ ÑĞ¾Ğ±ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ½Ğ°Ğ±Ğ¾Ñ€ Ñ‚ĞµÑÑ‚Ğ¾Ğ² (184 ÑˆÑ‚ÑƒĞº) Ğ½Ğ° `node:test` â€” ÑĞ¼. `examples/game-hub/README.md`:

```bash
cd examples/game-hub
npm test          # Unit (49) + API (24) + Blox (30) + M3 (12) + UX (36) + GCP (20) + Perf (7) + Version (2) + Star Drop (4)
```

### CI

GitHub Actions (`.github/workflows/framework-ci.yml`):

- Node.js 20 + 22
- Unit-Ñ‚ĞµÑÑ‚Ñ‹
- TypeScript strict-Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°

---

## ğŸš€ Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹

### Docker

```dockerfile
FROM node:20-slim AS builder
WORKDIR /app
COPY . .
RUN npm ci && npm run build

FROM node:20-slim
WORKDIR /app
COPY --from=builder /app/dist ./dist
COPY --from=builder /app/node_modules ./node_modules
COPY --from=builder /app/package.json .
COPY --from=builder /app/data ./data
ENV NODE_ENV=production
EXPOSE 8080
CMD ["node", "server.js"]
```

### Google Cloud Run

```bash
gcloud run deploy my-game --source . --set-env-vars="DISCORD_CLIENT_ID=...,DISCORD_CLIENT_SECRET=..."
```

---

## ğŸ”„ ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ

Ğ¤Ñ€ĞµĞ¹Ğ¼Ğ²Ğ¾Ñ€Ğº Ğ¶Ğ¸Ğ²Ñ‘Ñ‚ Ğ² `framework/` Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾ Ñ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞ¹ Ğ¸Ğ³Ñ€Ğ¾Ğ¹. **ĞĞ¾Ğ»ÑŒ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹** Ğ² Ğ¾Ñ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¼ ĞºĞ¾Ğ´Ğµ.

ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸: `framework/docs/migration.md`

### Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ·Ğ°Ğ¼ĞµĞ½ Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹

| Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ Ñ„Ğ°Ğ¹Ğ»           | ĞœĞ¾Ğ´ÑƒĞ»ÑŒ Ñ„Ñ€ĞµĞ¹Ğ¼Ğ²Ğ¾Ñ€ĞºĞ°         |
| --------------------------- | ------------------------- |
| `services/eventBus.ts`      | `EventBus`                |
| `services/discord.ts`       | `DiscordBridge`           |
| `services/contentLoader.ts` | `ContentManager`          |
| `server/storage.js`         | `LocalFileAdapter` / GCS  |
| `server/contentManager.js`  | `ContentManager` (ÑĞµÑ€Ğ²ĞµÑ€) |

---

## ğŸ“– API Reference

ĞŸĞ¾Ğ»Ğ½Ğ°Ñ ÑĞ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ¿Ğ¾ ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ğ¼ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑĞ¼:

### ĞšĞ»Ğ°ÑÑÑ‹

| ĞšĞ»Ğ°ÑÑ                 | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ                                |
| --------------------- | ----------------------------------------- |
| `EventBus`            | Pub/sub Ğ´Ğ»Ñ Ğ´ĞµĞºĞ°ÑƒĞ¿Ğ»ĞµĞ½Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ¼ÑƒĞ½Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸     |
| `StateManager<T>`     | Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‚ĞµĞ¹Ñ‚Ğ¾Ğ¼ Ñ Ğ´ĞµĞ±Ğ°ÑƒĞ½ÑĞ¾Ğ¼ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğ¹ |
| `MemoryAdapter<T>`    | In-memory Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ                       |
| `LocalFileAdapter<T>` | JSON-Ñ„Ğ°Ğ¹Ğ» Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ                       |
| `DiscordBridge`       | Discord SDK Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ°                       |
| `ContentManager`      | Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°/ĞºĞµÑˆ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°                     |
| `AssetManager`        | Ğ¡Ğ¿Ñ€Ğ°Ğ¹Ñ‚/Ğ°ÑƒĞ´Ğ¸Ğ¾ Ğ¿Ğ°Ğ¹Ğ¿Ğ»Ğ°Ğ¹Ğ½                     |
| `BaseServer<T>`       | Express-Ñ„Ğ°Ğ±Ñ€Ğ¸ĞºĞ° Ñ auth/CRUD/admin         |
| `BaseScene`           | Phaser 3 ÑÑ†ĞµĞ½Ğ° Ñ ÑĞµÑ‚ĞºĞ¾Ğ¹ Ğ¸ Ğ¿ÑƒĞ»Ğ°Ğ¼Ğ¸          |
| `I18n`                | Ğ˜Ğ½Ñ‚ĞµÑ€Ğ½Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ                       |
| `PluginManager<T>`    | ĞœĞµĞ½ĞµĞ´Ğ¶ĞµÑ€ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ²                         |

### Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸

| Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ                   | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ                        |
| ------------------------- | --------------------------------- |
| `definePlugin()`          | Ğ¢Ğ¸Ğ¿Ğ¾Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°   |
| `loadGameConfig()`        | Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ° Ñ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ°Ğ¼Ğ¸      |
| `loadGameConfigWithEnv()` | Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ° + env-Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ |

### Ğ¡Ğ¸Ğ½Ğ³Ğ»Ñ‚Ğ¾Ğ½Ñ‹

| Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚               | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ              |
| --------------------- | ----------------------- |
| `gameBus`             | Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ EventBus     |
| `i18n`                | Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ I18n-Ğ¸Ğ½ÑÑ‚Ğ°Ğ½Ñ |
| `DEFAULT_GAME_CONFIG` | ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ     |

---

## ğŸ“„ Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ

MIT
